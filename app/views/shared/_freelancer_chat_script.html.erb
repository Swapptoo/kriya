<%- new_user ||= false %>
<script>

  var sign_up = [
    'Please choose your sign up mode',
    {
      type: 'visit',
      answers: [{
        'text': 'Twitter',
        'path': '/auth/twitter?user=freelancer'
      },{
        'text': 'Facebook',
        'path': '/auth/facebook?user=freelancer'
      },{
        'text': 'LinkedIn',
        'path': '/auth/linkedin?user=freelancer'
      },{
        'text': 'Email',
        'path': '/freelancers/sign_up'
      }]
    }
  ];
  var login = [
    'Cool, please login to get to your projects',
    {
      type: 'visit',
      answers: [{
        'text': 'Twitter',
        'path': '/auth/twitter?user=freelancer'
      },{
        'text': 'Facebook',
        'path': '/auth/facebook?user=freelancer'
      },{
        'text': 'LinkedIn',
        'path': '/auth/linkedin?user=freelancer'
      },{
        'text': 'Email',
        'path': '/freelancers/sign_in'
      }]
    }
  ];
  var dummy = [
    '',
    {
      type: 'submitDummy',
      path: 'signup',
      key: 'submit-dummy'
    }
  ];

  var description = [
    'We will email you soon when there\'s a gig. Keep watching this space'
  ];

  <%- if new_user %>
    var configs = {
      greeting: [
        'Hi, I am Kriya Bot. Welcome! We provide on demand workforce for people to work done by high quality, cost effective freelancers across the world. Get started to join our network',
        {
          type: 'choose',
          answers: [
            {
              'text': 'Get Started',
              'path': 'signup'
            },
            {
              'text': 'Sign In',
              'path': 'login'
            }
          ]
        }
      ],
      dummy: dummy,
      login: login,
      signup: sign_up
    };
  <%- else %>
    <%- if current_freelancer.pending_rooms.any? %>
      <%- unless @room.accepted_freelancers.any? %>
        var description = [
          'You are now asigned to <%= @room.title %>. Are you available to finish this project within the given timeline? <br> <%= @room.posts.first.content.split.join(' ').html_safe %>',
          {
            type: 'visit',
            path: 'notice',
            key: "description",
            answers: [{
              'text': 'Accept',
              'path': '/tasks/<%= @room.id %>/accept' ,
              'key': 'quality'
            },{
              'text': 'Pass',
              'path': '/tasks/<%= @room.id %>/reject' ,
              'key': 'quality'
            }]
          }
        ];
      <%- else %>
        var description = [
          "Sorry the task has already been assigned to someone else as they claimed it first."
        ];
      <%- end %>
      var configs = {
        greeting: description
      };
    <%- end %>
  <%- end %>

  new Chat(
    configs,
    {
      targetNode: '#chat'
    }
  );
</script>
